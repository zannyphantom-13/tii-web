<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin Login - The Informatics Initiative</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
</head>
<body class="login-body">
  <header class="admin-header">
    <!-- Updated logo to link back to index.html -->
    <a href="/Tii/index.html">
        <div class="logo-container">
          <svg class="logo-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <polygon points="50,5 90,30 90,70 50,95 10,70 10,30" fill="transparent" stroke="#2a6e62" stroke-width="5"/>
            <circle cx="50" cy="50" r="10" fill="#2a6e62"/>
            <path d="M50 5 L50 95 M10 30 L90 70 M10 70 L90 30" stroke="#2a6e62" stroke-width="2"/>
          </svg>
          <h1>ADMIN LOGIN</h1>
        </div>
    </a>
  </header>

  <main class="login-main">
    <div class="login-container admin-login-container">
      <h3><i class="fas fa-lock"></i> Secure Admin Access</h3>
      
      <!-- General Error Display Area -->
      <div id="admin-login-error" class="error-message" style="color: red; margin-top: 15px; text-align: center; display: none;"></div>

      <!-- Step 1: Credentials Form (Visible by default) -->
      <form id="admin-login-step1-form">
        <div class="form-group">
          <label for="email"><i class="fas fa-envelope"></i> Email</label>
          <input type="email" id="email" placeholder="Admin email" required />
        </div>

        <div class="form-group password-container">
          <label for="password"><i class="fas fa-key"></i> Password</label>
          <input type="password" id="password" placeholder="Password" required data-target="password" />
          <i class="fas fa-eye toggle-password" data-target="password"></i>
        </div>
        
        <button type="submit" class="submit-btn admin-submit-btn" id="login-step1-btn">Login / Check Status</button>
      </form>

      <!-- Step 2: Token Verification (Hidden by default) -->
      <form id="admin-login-step2-form" class="hidden">
        <div class="form-group">
          <label for="token"><i class="fas fa-shield-alt"></i> Admin Token</label>
          <input type="text" id="token" placeholder="Enter token sent to admin email" />
        </div>

        <!-- Resend Token Button & Timer -->
        <div class="resend-container">
            <button type="button" class="link-like-button" id="resend-token-btn" disabled>Resend Token</button>
            <span id="resend-timer" class="timer-display"></span>
        </div>

        <button type="submit" class="submit-btn admin-submit-btn">Verify & Complete Login</button>
      </form>
      
      <!-- Added Back to Student Login link -->
      <div class="register-link" style="padding-top: 10px; border-top: none; margin-top: 15px;">
        <p><a href="/Tii/login.html" style="font-weight: normal; color: #666;">&larr; Back to Student Login</a></p>
      </div>

    </div>
  </main>

  <footer>
    <div class="copyright-bar">
      <p>&copy; 2024 The Informatics Initiative. All rights reserved.</p>
    </div>
  </footer>

  <!-- Load global user scripts first -->
  <script type="module" src="./user-loader.js"></script>
  
  <!-- Load main auth logic, which contains the new initializeAdminLogin function -->
  <script type="module">
    import { initializeAdminLogin } from './auth.js';
    
    // This single function will set up everything for this page
    initializeAdminLogin();
  </script>
</body>
</html>